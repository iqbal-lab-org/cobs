name: COBS builds

on:
  push:
    branches:
      - master
  pull_request:
    branches:
      - master

jobs:
#  linux_build:
#    name: Build and test linux
#    runs-on: ubuntu-20.04
#    steps:
#    - name: Install dependencies
#      run: |
#        sudo apt-get install cmake
#        cmake --version
#        gcc --version
#        g++ --version
#
#    - name: Check out code for the build
#      uses: actions/checkout@v2
#      with:
#        submodules: recursive
#
#    - name: Build and test
#      run: |
#        mkdir build
#        cd build
#        cmake ..
#        make
#        make test
#
#  mac_build_gcc:
#    name: Build and test Mac OS X with gcc
#    runs-on: macos-11
#    steps:
#      - name: Install dependencies
#        run: |
#          brew install cmake gcc@12
#          which gcc-12
#          which g++-12
#          cmake --version
#          gcc-12 --version
#          g++-12 --version
#
#      - name: Check out code for the build
#        uses: actions/checkout@v2
#        with:
#          submodules: recursive
#
#      - name: Build and test
#        run: |
#          mkdir build
#          cd build
#          cmake -DCMAKE_C_COMPILER=gcc-12 -DCMAKE_CXX_COMPILER=g++-12 ..
#          make
#          make test

  mac_build_clang:
    name: Build and test Mac OS X with clang
    runs-on: macos-11
    steps:
      - name: Install dependencies
        run: |
          brew install cmake boost@1.76
          brew reinstall libomp

      - name: Check out code for the build
        uses: actions/checkout@v2
        with:
          submodules: recursive

      - name: Build and test
        run: |
          mkdir build
          cd build
          export LDFLAGS="-L/usr/local/opt/boost@1.76/lib"
          export CPPFLAGS="-I/usr/local/opt/boost@1.76/include"
          cmake -DBOOST=1 ..
          make
          make test
